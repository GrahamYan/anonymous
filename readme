This is the revision of submission 4078 for ICML23.
